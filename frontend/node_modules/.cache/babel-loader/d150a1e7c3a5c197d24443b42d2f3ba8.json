{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mmick\\\\Documents\\\\eget\\\\songplacer\\\\SongPlacer\\\\frontend\\\\src\\\\pages\\\\library\\\\Playlist.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useContext, useState } from 'react';\nimport Axios from 'axios';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCirclePlus } from '@fortawesome/free-solid-svg-icons';\nimport '../../globals/Globals.css';\nimport './Library.css';\nimport { UserContext } from '../../context';\nimport usePages from '../usePages';\nimport ListedSongPlace from '../../components/common/ListedSongplace';\nimport EditPlaylist from '../../components/common/EditPlaylist';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Playlist = () => {\n  _s();\n\n  const pagesHelp = usePages();\n  const pages = pagesHelp.pages;\n  const context = useContext(UserContext);\n  const userId = context.userId;\n  const currUrl = new URL(window.location.href);\n  const playlistId = currUrl.searchParams.get('playlist-id');\n  console.log('pl id: ' + playlistId);\n  const [songplaces, setSongplaces] = useState([]);\n  const [isLoading, setLoading] = useState(true);\n  const [plName, setPlaylistName] = useState('spellistenamn wihu');\n  const [showEdit, setShowEdit] = useState(false);\n  const [isOwned, setIsOwned] = useState(false);\n\n  const getSongPlaces = () => {\n    //notice backticks ` \n    const getUrl = `http://localhost:3001/library/${userId}/${playlistId}/songplaces`;\n    Axios.get(getUrl).then(response => {\n      setSongplaces(response.data);\n    }).catch(err => {\n      console.log('get songplaces error');\n    });\n  };\n  /**\r\n   * Deletes playlist (and songplaces in it). On success goes back to library. \r\n   */\n\n\n  const deletePlaylist = () => {\n    //notice backticks ` \n    const deleteUrl = `http://localhost:3001/library/${userId}/delete-playlist/${playlistId}`;\n    Axios.delete(deleteUrl).then(response => {\n      if (!response.status == 200) {\n        console.log('playlist could not be deleted, status = ' + response.status);\n      } else {\n        window.history.go(-1);\n      }\n    }).catch(err => {\n      console.log('playlist could not be deleted');\n    });\n  };\n\n  const handleDeleteClick = () => {\n    if (window.confirm('Delete playlist?')) {\n      deletePlaylist();\n    }\n  };\n\n  const getAddClickLocation = () => {\n    let url = pagesHelp.getURL(pages.addsongplace);\n    url.searchParams.set('playlist-id', playlistId);\n    return url;\n  };\n\n  const getPlaylistName = () => {\n    Axios.get(`http://localhost:3001/get-playlist/${playlistId}`).then(response => {\n      if (response.status == 200) {\n        console.log(\"get name data: \" + JSON.stringify(response.data[0].name));\n        return response.data[0].name;\n      } else {\n        console.log(\"get playlist name error: \");\n      }\n    }).catch(err => console.log(\"get playlist name error: \" + err));\n  };\n  /**\r\n   * Sets loading to false if data has been fetched\r\n   */\n\n\n  useEffect(() => {\n    if (songplaces !== null && songplaces !== undefined) {\n      setLoading(false);\n    }\n  }, [songplaces]);\n  /**\r\n   * Fetches songplaces in playlist after render\r\n   */\n\n  useEffect(() => {\n    getSongPlaces();\n  }, []);\n  /**\r\n   * Sets playlist name\r\n   */\n\n  useEffect(() => {\n    setPlaylistName(\"useEffect nnn\");\n  }, []);\n  /**\r\n   * Sets isOwned to true if user owns playlist\r\n   */\n\n  useEffect(() => {\n    getSongPlaces();\n  }, []);\n  /**\r\n   * Check if user owns playlist and sets variable 'isOwned'\r\n   */\n\n  useEffect(() => {\n    Axios.post('http://localhost:3001/verify-playlist-ownership', {\n      playlistId: playlistId,\n      userId: userId\n    }).then(response => {\n      if (response.status != 200) {\n        console.log('Could not verify playlist ownership');\n        setIsOwned(false);\n      }\n\n      setIsOwned(response.data.ownership);\n    }).catch(err => {\n      console.log('Could not verify playlist ownership');\n      setIsOwned(false);\n    });\n  }, []); //todo: differentiate between no song-places and no data fetched\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"library-outmost margin-top\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: plName\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }, this), isLoading ? /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 21\n    }, this) : songplaces.map((songplace, index) => /*#__PURE__*/_jsxDEV(ListedSongPlace, {\n      songplace: songplace,\n      playlistId: playlistId,\n      isOwned: isOwned\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 21\n    }, this)), /*#__PURE__*/_jsxDEV(\"a\", {\n      href: getAddClickLocation(),\n      children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n        icon: faCirclePlus,\n        size: \"4x\",\n        className: \"icon add-button\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 13\n    }, this), isOwned ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => handleDeleteClick(),\n        children: \"Delete playlist\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 29\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setShowEdit(!showEdit),\n        children: \"Edit playlist name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 29\n      }, this), /*#__PURE__*/_jsxDEV(EditPlaylist, {\n        show: showEdit,\n        playlistId: playlistId,\n        playlistName: plName,\n        setPlaylistName: setPlaylistName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 29\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 144,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Playlist, \"nmNrmaU1tVYnZRyOhjksAguEgzs=\", false, function () {\n  return [usePages];\n});\n\n_c = Playlist;\nexport default Playlist;\n\nvar _c;\n\n$RefreshReg$(_c, \"Playlist\");","map":{"version":3,"names":["React","useEffect","useContext","useState","Axios","FontAwesomeIcon","faCirclePlus","UserContext","usePages","ListedSongPlace","EditPlaylist","Playlist","pagesHelp","pages","context","userId","currUrl","URL","window","location","href","playlistId","searchParams","get","console","log","songplaces","setSongplaces","isLoading","setLoading","plName","setPlaylistName","showEdit","setShowEdit","isOwned","setIsOwned","getSongPlaces","getUrl","then","response","data","catch","err","deletePlaylist","deleteUrl","delete","status","history","go","handleDeleteClick","confirm","getAddClickLocation","url","getURL","addsongplace","set","getPlaylistName","JSON","stringify","name","undefined","post","ownership","map","songplace","index"],"sources":["C:/Users/mmick/Documents/eget/songplacer/SongPlacer/frontend/src/pages/library/Playlist.js"],"sourcesContent":["import React, { useEffect, useContext, useState} from 'react';\r\nimport Axios from 'axios';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faCirclePlus } from '@fortawesome/free-solid-svg-icons'\r\nimport '../../globals/Globals.css';\r\nimport './Library.css';\r\nimport { UserContext } from '../../context';\r\nimport usePages from '../usePages';\r\nimport ListedSongPlace from '../../components/common/ListedSongplace';\r\nimport EditPlaylist from '../../components/common/EditPlaylist';\r\n\r\nconst Playlist = () => {\r\n\r\n    const pagesHelp = usePages();\r\n    const pages = pagesHelp.pages;\r\n    \r\n    const context = useContext(UserContext);\r\n    const userId = context.userId;\r\n\r\n    const currUrl = new URL(window.location.href);\r\n    const playlistId = currUrl.searchParams.get('playlist-id');\r\n    console.log('pl id: ' + playlistId);\r\n\r\n\r\n    const [songplaces, setSongplaces] = useState([]);\r\n    const [isLoading, setLoading] = useState(true);\r\n    const [plName, setPlaylistName] = useState('spellistenamn wihu');\r\n    const [showEdit, setShowEdit] = useState(false);\r\n\r\n    const [isOwned, setIsOwned] = useState(false);\r\n\r\n   \r\n    const getSongPlaces = () => {\r\n        //notice backticks ` \r\n        const getUrl = `http://localhost:3001/library/${userId}/${playlistId}/songplaces`; \r\n\r\n        Axios.get(getUrl)\r\n        .then((response) => {\r\n            setSongplaces(response.data);\r\n        }).catch((err) => {\r\n            console.log('get songplaces error');\r\n        });\r\n\r\n    }\r\n\r\n    /**\r\n     * Deletes playlist (and songplaces in it). On success goes back to library. \r\n     */\r\n    const deletePlaylist = () => {\r\n\r\n        //notice backticks ` \r\n        const deleteUrl = `http://localhost:3001/library/${userId}/delete-playlist/${playlistId}`; \r\n\r\n        Axios.delete(deleteUrl).then((response) => {\r\n            if (!response.status == 200) {\r\n                console.log('playlist could not be deleted, status = ' + response.status);\r\n            } else {\r\n                window.history.go(-1);\r\n            }\r\n        }).catch((err) => {\r\n            console.log('playlist could not be deleted');\r\n        });\r\n    }\r\n \r\n    const handleDeleteClick = () => {\r\n        if (window.confirm('Delete playlist?')) {\r\n            deletePlaylist();\r\n        }\r\n    }\r\n\r\n    const getAddClickLocation = () => {\r\n        let url = pagesHelp.getURL(pages.addsongplace);\r\n        url.searchParams.set('playlist-id', playlistId);\r\n        return url;\r\n    }\r\n\r\n    const getPlaylistName = () => {\r\n        Axios.get(`http://localhost:3001/get-playlist/${playlistId}`).then((response) => {\r\n            if (response.status == 200) {\r\n                console.log(\"get name data: \" + JSON.stringify(response.data[0].name));\r\n                return response.data[0].name;\r\n            } else {\r\n                console.log(\"get playlist name error: \");\r\n            }\r\n        }).catch((err) => console.log(\"get playlist name error: \" + err));\r\n    }\r\n\r\n    /**\r\n     * Sets loading to false if data has been fetched\r\n     */\r\n     useEffect(() => {\r\n        if (songplaces !== null && songplaces !== undefined) {\r\n            setLoading(false);\r\n        }\r\n    }, [songplaces]);\r\n\r\n\r\n    /**\r\n     * Fetches songplaces in playlist after render\r\n     */\r\n    useEffect(()=> {\r\n        getSongPlaces();\r\n    }, []);\r\n\r\n\r\n    /**\r\n     * Sets playlist name\r\n     */\r\n     useEffect(()=> {\r\n        setPlaylistName(\"useEffect nnn\");\r\n    }, []);\r\n\r\n    /**\r\n     * Sets isOwned to true if user owns playlist\r\n     */\r\n     useEffect(()=> {\r\n        getSongPlaces();\r\n    }, []);\r\n\r\n  \r\n    \r\n\r\n    /**\r\n     * Check if user owns playlist and sets variable 'isOwned'\r\n     */\r\n     useEffect(() => {\r\n        Axios.post('http://localhost:3001/verify-playlist-ownership', {\r\n            playlistId: playlistId, \r\n            userId: userId\r\n        }).then((response) => {\r\n            if (response.status != 200) {\r\n                console.log('Could not verify playlist ownership');\r\n                setIsOwned(false);\r\n            }\r\n            setIsOwned(response.data.ownership);\r\n        }).catch((err) => {\r\n            console.log('Could not verify playlist ownership');\r\n            setIsOwned(false);\r\n        }); \r\n    }, []);\r\n\r\n    //todo: differentiate between no song-places and no data fetched\r\n    return ( \r\n        <div className='library-outmost margin-top'>\r\n            <h2>{plName}</h2>\r\n            {\r\n            isLoading ? \r\n                    <h2>Loading...</h2>\r\n                :\r\n                songplaces.map((songplace, index) => (\r\n                    <ListedSongPlace songplace={songplace} key={index} playlistId={playlistId} isOwned={isOwned}></ListedSongPlace>\r\n                ))\r\n            }\r\n            \r\n            <a href={getAddClickLocation()}>  \r\n            <FontAwesomeIcon icon={faCirclePlus} size='4x' className='icon add-button'/>\r\n            </a>\r\n            \r\n            {\r\n                isOwned ? \r\n                        <>\r\n                            <button onClick={() => handleDeleteClick()}>Delete playlist</button>\r\n                            <button onClick={() => setShowEdit(!showEdit)}>Edit playlist name</button>\r\n                            <EditPlaylist show={showEdit} playlistId={playlistId} playlistName={plName} setPlaylistName={setPlaylistName}/>\r\n                        </>\r\n                    :\r\n                        <></>\r\n\r\n            }\r\n            \r\n        </div>\r\n    );\r\n}\r\n\r\n\r\nexport default Playlist;"],"mappings":"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"},"metadata":{},"sourceType":"module"}